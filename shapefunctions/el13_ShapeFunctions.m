function [NN,Nr,Ns,Nt] = el13_ShapeFunctions(r,s,t)

%% Compute shape functions for element 13: quadratic 18 node wedge
% triangle part: $ r \in [-1,1] $, $ s \in [-1,1] $, $ r + s \leq 0 $
% $ t \in [-1,1]$

NN = [(1/4).*(r+s).*(1+r+s).*((-1)+t).*t,(1/4).*r.*(1+r).*((-1)+t).*t,( ...
  1/4).*s.*(1+s).*((-1)+t).*t,(1/4).*(r+s).*(1+r+s).*t.*(1+t),(1/4) ...
  .*r.*(1+r).*t.*(1+t),(1/4).*s.*(1+s).*t.*(1+t),(-1/2).*(1+r).*(r+ ...
  s).*((-1)+t).*t,(-1/2).*(1+s).*(r+s).*((-1)+t).*t,(-1/2).*(r+s).*( ...
  1+r+s).*((-1)+t).*(1+t),(1/2).*(1+r).*(1+s).*((-1)+t).*t,(-1/2).* ...
  r.*(1+r).*((-1)+t).*(1+t),(-1/2).*s.*(1+s).*((-1)+t).*(1+t),(-1/2) ...
  .*(1+r).*(r+s).*t.*(1+t),(-1/2).*(1+s).*(r+s).*t.*(1+t),(1/2).*(1+ ...
  r).*(1+s).*t.*(1+t),(1+r).*(r+s).*((-1)+t).*(1+t),(1+s).*(r+s).*(( ...
  -1)+t).*(1+t),(-1).*(1+r).*(1+s).*((-1)+t).*(1+t)];

Nr = [(1/4).*(1+2.*r+2.*s).*((-1)+t).*t,(1/4).*(1+2.*r).*((-1)+t).*t,0, ...
  (1/4).*(1+2.*r+2.*s).*t.*(1+t),(1/4).*(1+2.*r).*t.*(1+t),0,(-1/2) ...
  .*(1+2.*r+s).*((-1)+t).*t,(-1/2).*(1+s).*((-1)+t).*t,(-1/2).*(1+ ...
  2.*r+2.*s).*((-1)+t.^2),(1/2).*(1+s).*((-1)+t).*t,(-1/2).*(1+2.*r) ...
  .*((-1)+t.^2),0,(-1/2).*(1+2.*r+s).*t.*(1+t),(-1/2).*(1+s).*t.*(1+ ...
  t),(1/2).*(1+s).*t.*(1+t),(1+2.*r+s).*((-1)+t).*(1+t),(1+s).*((-1) ...
  +t).*(1+t),(-1).*(1+s).*((-1)+t).*(1+t)];

Ns = [(1/4).*(1+2.*r+2.*s).*((-1)+t).*t,0,(1/4).*(1+2.*s).*((-1)+t).*t, ...
  (1/4).*(1+2.*r+2.*s).*t.*(1+t),0,(1/4).*(1+2.*s).*t.*(1+t),(-1/2) ...
  .*(1+r).*((-1)+t).*t,(-1/2).*(1+r+2.*s).*((-1)+t).*t,(-1/2).*(1+ ...
  2.*r+2.*s).*((-1)+t.^2),(1/2).*(1+r).*((-1)+t).*t,0,(-1/2).*(1+2.* ...
  s).*((-1)+t.^2),(-1/2).*(1+r).*t.*(1+t),(-1/2).*(1+r+2.*s).*t.*(1+ ...
  t),(1/2).*(1+r).*t.*(1+t),(1+r).*((-1)+t).*(1+t),(1+r+2.*s).*((-1) ...
  +t).*(1+t),(-1).*(1+r).*((-1)+t).*(1+t)];

Nt = [(1/4).*(r+s).*(1+r+s).*((-1)+2.*t),(1/4).*r.*(1+r).*((-1)+2.*t),( ...
  1/4).*s.*(1+s).*((-1)+2.*t),(1/4).*(r+s).*(1+r+s).*(1+2.*t),(1/4) ...
  .*r.*(1+r).*(1+2.*t),(1/4).*s.*(1+s).*(1+2.*t),(1/2).*(1+r).*(r+s) ...
  .*(1+(-2).*t),(1/2).*(1+s).*(r+s).*(1+(-2).*t),(-1).*(r+r.^2+s+2.* ...
  r.*s+s.^2).*t,(1/2).*(1+r).*(1+s).*((-1)+2.*t),(-1).*r.*(1+r).*t,( ...
  -1).*s.*(1+s).*t,(-1/2).*(1+r).*(r+s).*(1+2.*t),(-1/2).*(1+s).*(r+ ...
  s).*(1+2.*t),(1/2).*(1+r).*(1+s).*(1+2.*t),2.*(1+r).*(r+s).*t,2.*( ...
  1+s).*(r+s).*t,(-2).*(1+r).*(1+s).*t];
